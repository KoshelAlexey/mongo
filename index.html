<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link media="all" rel="stylesheet" href="public/stylesheets/style.css">
    <!--angular-->
    <script type="text/javascript" src="node_modules/angular/angular.min.js"></script>
    <script type="text/javascript" src="node_modules/angular-route/angular-route.min.js"></script>
    <script type="text/javascript" src="node_modules/angular-sanitize/angular-sanitize.min.js"></script>
    <!--core-->
    <script type="text/javascript" src="app/main.js"></script>
    <!--services-->
    <script type="text/javascript" src="app/services/userDbStructureService.js"></script>
    <!--controllers-->
    <script type="text/javascript" src="app/controllers/parentController.js"></script>
 </head>
<body ng-app="mongo-app">
    <div class="main-content" ng-controller="parentController">
        <p><button type="button" ng-click="addCollection(dbStructure)">Добавить коллекцию</button></p>
        <form class="bdentity-wrapper" ng-repeat="item in dbStructure.collections">
            <p>
                <label><span>Имя коллекции: </span><input type="text" ng-model="item.name"></label>
            </p>
            <hr>
            <p>Отношения к другим коллекциям:</p>
            <p><button type="button" ng-click="addRelation(item)">Добавить отношения</button></p>
            <p ng-repeat="relation in item.relations">
                <span>Коллекция: </span>
                <select ng-model="relation.reliedTo">
                    <option ng-repeat="item in dbStructure.collections" value="{{item.name}}">{{item.name}}</option>
                </select>
                <span>Тип отношения: </span>
                <select ng-model="relation.relationType">
                    <option ng-repeat="type in colRelationSelect" value="{{type.value}}">{{type.name}}</option>
                </select>
            </p>
            <hr>
            <p>
                <button type="button" ng-click="addField(item)">Добавить поле</button>
            </p>
            <fieldset ng-repeat="field in item.fields">
                <label><span>Поиск по полю </span><input type="checkbox" ng-model="field.searchable"></label>
                <label><span>Название поля: </span><input type="text" ng-model="field.name"></label>
                <label>
                    <span>Тип: </span>
                    <select ng-model="field.type">
                        <option ng-repeat="fieldType in fieldTypesSelect" value="{{fieldType.value}}">{{fieldType.name}}</option>
                    </select>
                </label>
                <button type="button" ng-click="removeField(item, field)">Удалить поле</button>
            </fieldset>
        </form>
        <p>
            <button type="button" ng-click="sendData(dbStructure)">Отправить данные</button>
            <button type="button" ng-click="getBuild()">Построить базу</button>
            <button type="button" ng-click="startTest()">Начать тестирование</button>
        </p>
        <div class="stat-bar" ng-model="$scope.status">
            <table class="stat-table">
                <tbody>
                <tr>
                    <td><div ng-class="status.schema ? 'stat-on':'stat-off'"></div></td>
                    <td><div ng-class="status.base ? 'stat-on':'stat-off'"></div></td>
                    <td><div ng-class="status.tests ? 'stat-on':'stat-off'"></div></td>
                </tr>
                <tr>
                    <td>schema</td>
                    <td>base</td>
                    <td>tests</td>
                </tr>
                </tbody>
            </table>

    </div>
</body>
</html>